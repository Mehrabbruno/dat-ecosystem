
module.exports = icon_button

// CSS Boiler Plat
const sheet = new CSSStyleSheet
const theme = get_theme()
sheet.replaceSync(theme)



var id = 0

// opts - icon/img src
function icon_button (opts, protocol) {

    const name = `icon_button_${id++}`
    let {src, src_active} = opts

    const el = document.createElement('div')
    const shadow = el.attachShadow({mode:'closed'})

    const icon_button = document.createElement('div')
    icon_button.classList.add('icon_btn')
    
    const icon = document.createElement('img')
    icon.src = src
    icon_button.append(icon)

    // Toggle Icon
    if(src_active){
        let activeState = true;
        icon_button.onclick = (e) =>{
            ;(activeState)?icon.src = src_active: icon.src = src
            activeState = !activeState
            toggle_class(e)
        }
    }else{
        // Toggle Class
        icon_button.onclick = (e) => toggle_class(e)
    }

    const style = document.createElement('style')
    style.textContent = get_theme()

    shadow.append(icon_button, style)
    shadow.adoptedStyleSheets = [sheet]
    return el
}



function get_theme(){
    return`
        .icon_btn{
            display:flex;
            justify-content: center;
            align-items:center;
            height:40px;
            box-sizing:border-box;
            aspect-ratio:1/1;
            cursor:pointer;
            border: 1px solid var(--primary_color);
            background-color: var(--bg_color);
        }
        .icon_btn img{
            height:25px;
            width: 25px;
            pointer-events:none;
        }
        .icon_btn.active{
            background-color: var(--ac-2)
        }
    `
}



function toggle_class(e){
    let selector = e.target.classList
    ;( selector.contains('active') ) ? selector.remove('active') : selector.add('active')
}